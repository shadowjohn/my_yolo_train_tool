<!--
    圖片標記

-->
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>我的 yolo 訓練機</title>
    <script src="/www/js/jquery.min.js"></script>
    <script src="/www/js/myphp.js"></script>
    <script src="/www/js/mybox.js"></script>
    <script src="/www/js/include.js"></script>
    <link rel="stylesheet" href="/www/css/reset.css" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/www/css/style.css" />
    <script src="/www/js/jQuery-Plugin-For-Selecting-Multiple-Areas-of-An-Image-Select-Areas/jquery.selectareas.js"></script>
    <link rel="stylesheet" href="/www/js/jQuery-Plugin-For-Selecting-Multiple-Areas-of-An-Image-Select-Areas/resources/jquery.selectareas.css" />

    <style>
        .thetable {
            width: 100%;
        }
    </style>
</head>
<body class="container mt-5">
    <div reqc="kindLists">
        <!-- 這裡列出類別 -->
        <!-- 用 select 列 -->
        <select reqc="selKindname"></select>

    </div>
    <hr class="my-4" style="border-color: red;" />
    <div id="divMain">

    </div>
</body>
</html>
<script>
    // 取得照片分類
    var GETS = getGET();
    var PROJECT_NAME = GETS["project_name"];
    console.log(PROJECT_NAME);
    // 取得照片分類
    window['kind_lists'] = [];
    myAjax_async_json("/api?mode=getDoMarkKindList", { "project_name": PROJECT_NAME }, function (jd) {
        if (jd.status == 'OK') {
            window['kind_lists'] = jd.kind_lists;
            var m = [];
            for (var i = 0; i < jd.kind_lists.length; i++) {
                var kind = jd.kind_lists[i];
                var isSelected = (i == 0) ? "selected" : "";
                // 是否有待處理的照片
                var isNeedProcess = (kind.need_process == 1) ? ` (總數: ${kind.total_pics} 張, 待處理: ${kind.need_process_counts} 張)`: ` (總數: ${kind.total_pics} 張)`;
                var d = `<option value="${kind.kind_name}" ${isSelected}>${kind.kind_name}${isNeedProcess}</option>`;
                m.push(d);
            }
            $("select[reqc='selKindname']").html(m.join(''));
            $("select[reqc='selKindname']").off().change(function () {
                var kind_name = $(this).val();
                myAjax_async_json("/api?mode=getMY_DATASETSPhotos", { "project_name": PROJECT_NAME, "kind_name": kind_name }, function (jd) {
                    if (jd.status == 'OK') {
                        var m = [];
                        for (var i = 0; i < jd.data.length; i++) {
                            var photo = jd.data[i];
                            var d = `<img src="${photo.photo_path}" style="width: 100px; height: 100px;" />`;
                            m.push(d);
                        }
                        $("#divMain").html(m.join(''));
                    }
                });
            }).trigger("change"); // 觸發一次
        }
    });
</script>
