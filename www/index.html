<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>我的 yolo 訓練機</title>

    <script src="/www/js/jquery.min.js"></script>
    <script src="/www/js/myphp.js"></script>
    <script src="/www/js/mybox.js"></script>
    <script src="/www/js/jquery.imgareaselect-0.9.8/scripts/jquery.imgareaselect.pack.js"></script>
    <script src="/www/js/include.js"></script>
    <link rel="stylesheet" href="/www/css/reset.css" />
    <link rel="stylesheet" href="/www/js/jquery.imgareaselect-0.9.8/css/imgareaselect-default.css" />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/www/css/style.css" />
</head>
<body class="container mt-5">
    <!-- 右上，新增專案 -->
    <div class="d-flex justify-content-end">
        <button type="button" reqc="btnAddProject" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProjectModal">
            新增專案
        </button>
    </div>

    <div class="form-group">
        <label for="project_name">選擇專案：</label>
        <select id="project_name" class="form-control">
            <option value="">請選擇</option>
            <!-- 這裡可以動態填充選項 -->
        </select>
    </div>
    <div id="divTop" class="d-flex justify-content-left align-items-center d-none" style="height: 55px; background-color: #f0f0f0;">
        <!-- 可以放功能列-->
        <a href="javascript:;" reqk="a功能按鈕" reqc="a物件清單" class="btn btn-secondary mx-2">物件清單</a>
        <a href="javascript:;" reqk="a功能按鈕" reqc="a照片分類" class="btn btn-secondary mx-2">照片分類</a>
        <a href="javascript:;" reqk="a功能按鈕" reqc="a圖框設定" class="btn btn-secondary mx-2">圖框設定</a>
    </div>
    <hr class="my-4" style="border-color: red;" />
    <div id="divMain">
        <!-- 這裡可以放主要內容 -->
    </div>
</body>
<script>
    var GETS = getGET();
    if (GETS["project_name"] == undefined) {
        GETS["project_name"] = "";
        $("#divTop").removeClass('d-none');
        $("#divTop").addClass('d-none');
    }
    else {
        $("#divTop").removeClass('d-none');
        setMemory("project_name", GETS["project_name"]);
    }
    var APP = {
        method: {
            "ui_init": function () {
                //列出專案
                APP.method.projects.project_list();
                //新增專案
                $("button[reqc='btnAddProject']").off().click(function () {
                    dialogMyBoxOn("請稍候", true, function () { });
                });
                // 定義按鈕
                $("a[reqc='a物件清單']").off().click(function () {
                    //改變按鈕樣式
                    $("a[reqk='a功能按鈕']").removeClass("btn-secondary");
                    $("a[reqk='a功能按鈕']").removeClass("btn-primary");
                    $("a[reqk='a功能按鈕']").addClass("btn-secondary");
                    $(this).removeClass("btn-secondary");
                    $(this).addClass("btn-primary");
                    $("#divMain").html(`
                        <iframe src="/www/kind_setting.html" class="iframe_class"></iframe>
                    `);
                    function adjustIframeHeight() {
                        const iframe = document.getElementById("iframeId");
                        if (iframe) {
                            iframe.style.height = (iframe.contentWindow.document.body.scrollHeight + 80) + "px";
                        }
                    }

                    // 監聽 iframe 的載入事件
                    $("#divMain iframe")[0].addEventListener("load", adjustIframeHeight);
                });

            },
            "projects": {
                "project_list": function () {
                    // 列出專案
                    myAjax_async_json("/api?mode=project_list", "", function (jd) {
                        var m = [];
                        var d = `<option value="">請選擇</option>`;
                        m.push(d);
                        jd.data.map(function (v) {
                            var d = `<option value="${v}">${v}</option>`;
                            m.push(d);
                        });
                        $("#project_name").html(m.join(""));
                        $("#project_name").val(GETS["project_name"]);
                        $("#project_name").off().change(function () {
                            var project_name = $(this).val();
                            if (project_name == "") {
                                return;
                            }
                            setMemory("project_name", project_name);
                            project_name = encodeURIComponent(project_name);
                            location.href = `/www/index.html?project_name=${project_name}`;
                        });
                    });
                }
            },
            "init": function () {
                APP.method.ui_init();
            }
        }
    };
    APP.method.init();
</script>
</html>
